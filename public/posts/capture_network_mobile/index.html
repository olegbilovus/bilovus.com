<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Capture Network Traffic on Mobile Devices - Oleg Bilovus&#39;s Tech Blog</title><meta name="Description" content="A tech blog where I share my knowledge and experiences on programming, web development, and technology."><meta property="og:url" content="https://bilovus.com/posts/capture_network_mobile/">
  <meta property="og:site_name" content="Oleg Bilovus&#39;s Tech Blog">
  <meta property="og:title" content="Capture Network Traffic on Mobile Devices">
  <meta property="og:description" content="A guide to capturing and analyzing mobile network traffic using invasive methods (PCAPdroid, Mitmproxy) and non-invasive techniques (OpenWRT router with tcpdump, port mirroring, LAN tap). Includes HTTPS decryption and real-time monitoring with Wireshark.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-15T18:21:02+01:00">
    <meta property="article:modified_time" content="2025-11-15T18:21:02+01:00">
    <meta property="article:tag" content="Network-Capture">
    <meta property="article:tag" content="Packet-Analysis">
    <meta property="article:tag" content="Tcpdump">
    <meta property="article:tag" content="Wireshark">
    <meta property="article:tag" content="Openwrt">
    <meta property="article:tag" content="Mitmproxy">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Capture Network Traffic on Mobile Devices">
  <meta name="twitter:description" content="A guide to capturing and analyzing mobile network traffic using invasive methods (PCAPdroid, Mitmproxy) and non-invasive techniques (OpenWRT router with tcpdump, port mirroring, LAN tap). Includes HTTPS decryption and real-time monitoring with Wireshark.">
<meta name="application-name" content="Oleg Bilovus&#39;s Tech Blog">
<meta name="apple-mobile-web-app-title" content="Oleg Bilovus&#39;s Tech Blog">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://bilovus.com/posts/capture_network_mobile/" /><link rel="next" href="https://bilovus.com/posts/secure-offline-data-storage-wear-os/" /><link rel="stylesheet" href="/css/style.min.c935ac3e67aabf8ffa880ec9a72bbd0fe11259f5ae50cb70025e417a80015536.css" integrity="sha256-yTWsPmeqv4/6iA7Jpyu9D+ESWfWuUMtwAl5BeoABVTY="><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Capture Network Traffic on Mobile Devices",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/bilovus.com\/posts\/capture_network_mobile\/"
        },"genre": "posts","keywords": "network-capture, packet-analysis, tcpdump, wireshark, openwrt, mitmproxy, pcapdroid, https-decryption, port-mirroring, vpn, traffic-monitoring, IoT","wordcount":  1078 ,
        "url": "https:\/\/bilovus.com\/posts\/capture_network_mobile\/","datePublished": "2025-11-15T18:21:02+01:00","dateModified": "2025-11-15T18:21:02+01:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Oleg Bilovus"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Oleg Bilovus&#39;s Tech Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials"
        data-srcset="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials, https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials 1.5x, https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials 2x"
        data-sizes="auto"
        alt="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials"
        title="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials" />Oleg Bilovus&#39;s Tech Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About Me </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Oleg Bilovus&#39;s Tech Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials"
        data-srcset="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials, https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials 1.5x, https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials 2x"
        data-sizes="auto"
        alt="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials"
        title="https://1.gravatar.com/avatar/268ae631934dbd631f4ec0e8a5694eb673ff3ca004ffb76802b3a22daeac44cb?size=512&amp;d=initials" />Oleg Bilovus&#39;s Tech Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About Me</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Capture Network Traffic on Mobile Devices</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://bilovus.com/about/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Oleg Bilovus</a></span>&nbsp;<span class="post-category">included in <a href="/categories/android/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Android</a>&nbsp;<a href="/categories/networking/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Networking</a>&nbsp;<a href="/categories/security/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Security</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-11-15">2025-11-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1078 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#invasive-method">Invasive Method</a>
      <ul>
        <li><a href="#packet-capture-application">Packet Capture Application</a></li>
        <li><a href="#proxy">Proxy</a></li>
      </ul>
    </li>
    <li><a href="#non-invasive-method">Non-Invasive Method</a>
      <ul>
        <li><a href="#openwrt-router-with-tcpdump">OpenWRT Router with Tcpdump</a></li>
        <li><a href="#port-mirroring--span">Port Mirroring / SPAN</a></li>
        <li><a href="#throwing-star-lan-tap">Throwing Star LAN Tap</a></li>
      </ul>
    </li>
    <li><a href="#decrypting-https-traffic">Decrypting HTTPS Traffic</a></li>
    <li><a href="#bibliography">Bibliography</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Capturing network traffic on mobile devices presents initial challenges, but appropriate tools and methods make the process straightforward and applicable to other devices such as IoT devices. This post focuses on Android devices.</p>
<p>Capture can be performed using an invasive approach, where the system or applications are aware of the capture process, or a non-invasive approach, where capture occurs externally without modifying the device or applications.</p>
<h2 id="invasive-method">Invasive Method</h2>
<p>With the Invasive Method, the applications being monitored can be aware of the capture process. When monitoring power consumption or hardware usage, this method introduces overhead due to the additional application running on the device.</p>
<h3 id="packet-capture-application">Packet Capture Application</h3>
<p>One popular open-source application is <a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture" target="_blank" rel="noopener noreffer ">PCAPdroid</a>, which enables capturing network traffic without root access. It creates a local VPN on the device to capture all network traffic.</p>
<p>This method has several limitations:</p>
<ul>
<li>Some applications may not work properly when a VPN is active.</li>
<li>The length of each captured frame packet can be inaccurate for some analysis; sometimes it may not show the single fragmented TCP packets but the reassembled packets as one.</li>
<li>Not all traffic is guaranteed to be captured; some system applications may use techniques to bypass the VPN.</li>
<li>ARP and other link-layer protocols are not captured; only IP traffic is captured.</li>
</ul>
<p>For most use cases, this method provides adequate coverage and straightforward setup. PCAPdroid also supports capturing traffic from specific applications, which reduces the amount of data captured.</p>
<h3 id="proxy">Proxy</h3>
<p>Using a proxy constitutes an invasive method, as the applications being monitored and the system are aware of the proxy settings due to the required device configuration.</p>
<p>A proxy can be configured at the router level instead of the device level, but this configuration may still be detected<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p>A commonly used proxy is <a href="https://mitmproxy.org/" target="_blank" rel="noopener noreffer ">Mitmproxy</a>, which enables capturing and modifying network traffic. It supports HTTP and HTTPS traffic, as well as other protocols.</p>
<h2 id="non-invasive-method">Non-Invasive Method</h2>
<p>The non-invasive method ensures that the applications and the system remain unaware of the capture process. This approach avoids introducing overhead on the device and can be applied to any network device, not just mobile devices.</p>
<p>The primary advantage of this method is its ability to capture all traffic, including ARP and other link-layer protocols. However, it cannot isolate traffic from a single application, as it captures all traffic on the network.</p>
<h3 id="openwrt-router-with-tcpdump">OpenWRT Router with Tcpdump</h3>
<p>A reliable method for capturing network traffic from mobile devices involves using a router with OpenWRT firmware and Tcpdump installed. This approach enables capturing all traffic on the network, including ARP and other link-layer protocols.</p>
<p>Tcpdump supports capturing traffic from specific devices by filtering based on MAC or IP addresses.</p>
<p>Multiple devices support OpenWRT firmware, and some ship with OpenWRT pre-installed, such as <a href="https://www.gl-inet.com/" target="_blank" rel="noopener noreffer ">GL.iNet routers</a>. The primary limitation of this method is the storage space on the router, as capturing all traffic can quickly consume available space. Capture can be performed remotely via SSH, and GL.iNet routers support USB and/or SD card storage expansion.</p>
<p>For extended capture sessions, implementing a system service that manages its lifecycle in case of failure is recommended.</p>
<p>Below is an example of a service file saved as <code>/etc/init.d/tcpdump_capture</code>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/sh /etc/rc.common
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">USE_PROCD</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">START</span><span class="o">=</span><span class="m">99</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">PROG</span><span class="o">=</span>/root/myservices/tcpdump.sh   <span class="c1"># Path to the traffic capture script</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">start_service<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    procd_open_instance
</span></span><span class="line"><span class="cl">    procd_set_param <span class="nb">command</span> <span class="nv">$PROG</span>
</span></span><span class="line"><span class="cl">    procd_set_param respawn     <span class="c1"># Automatically restart service if it crashes</span>
</span></span><span class="line"><span class="cl">    procd_set_param stdout <span class="m">1</span>    <span class="c1"># Redirect standard output to system log</span>
</span></span><span class="line"><span class="cl">    procd_set_param stderr <span class="m">1</span>    <span class="c1"># Redirect standard error to system log</span>
</span></span><span class="line"><span class="cl">    procd_close_instance
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div></div>
<p>To enable the service, run the following commands on the router:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-sh">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">chmod +x /etc/init.d/tcpdump_capture
</span></span><span class="line"><span class="cl">service tcpdump_capture <span class="nb">enable</span>  <span class="c1"># Enable the service to start on boot</span>
</span></span><span class="line"><span class="cl">service tcpdump_capture start</span></span></code></pre></div></div>
<p>The script <code>/root/myservices/tcpdump.sh</code> could be something like this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -e  <span class="c1"># Exit immediately if a command exits with a non-zero status</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">now</span><span class="o">=</span><span class="sb">`</span>date +<span class="s2">&#34;%Y-%m-%dT%H-%M-%S&#34;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Saves to external SD card in pcap directory</span>
</span></span><span class="line"><span class="cl"><span class="nv">out</span><span class="o">=</span><span class="s2">&#34;/tmp/mountd/disk1_part1/pcap/capture-</span><span class="nv">$now</span><span class="s2">.pcap&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$out</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/usr/sbin/tcpdump -i wlan0 -n -w <span class="nv">$out</span> host 192.168.0.10 or ether host xx:xx:xx:xx:xx:xx</span></span></code></pre></div></div>
<p>This script captures all traffic from a specific device on the network, based on its IP or MAC address, and saves it to an external SD card in pcap format.</p>
<p>For real-time traffic viewing, the latest captured pcap file can be piped to Wireshark running on a remote machine:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">eval</span> <span class="k">$(</span>ssh-agent -s<span class="k">)</span>     <span class="c1"># Start the SSH agent</span>
</span></span><span class="line"><span class="cl">ssh-add .ssh/gl_axt1800  <span class="c1"># Add the private key for authentication</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SSH into the router, tail the latest pcap file, and pipe it to Wireshark</span>
</span></span><span class="line"><span class="cl">ssh -i .ssh/gl_axt1800 root@192.168.8.1 <span class="s2">&#34;tail -n +1 -f /tmp/mountd/disk1_part1/pcap/\$(ls -t /tmp/mountd/disk1_part1/pcap/ | head -n 1)&#34;</span> <span class="p">|</span> wireshark -k -i -</span></span></code></pre></div></div>
<p>These commands establish an SSH session to the router, tail the latest pcap file, and pipe it to Wireshark running on the local machine for real-time viewing. Using ssh-agent avoids entering the password multiple times. Without the agent, the last command requires password entry.</p>
<h3 id="port-mirroring--span">Port Mirroring / SPAN</h3>
<p>When a router with OpenWRT is not available, network traffic can be captured using a managed switch with port mirroring or SPAN (Switched Port Analyzer) functionality. This method captures all traffic from a specific port on the switch and forwards it to another port where a capture device is connected.</p>
<div class="center">
    <a class="lightgallery" href="/images/posts/capture_network_mobile/port_mirroring.png" title="Port Mirroring" data-thumbnail="/images/posts/capture_network_mobile/port_mirroring.png" data-sub-html="<h2>Port Mirroring</h2>">
        <img style="display: block; margin-left: auto; margin-right: auto; width: 700px" src="/images/posts/capture_network_mobile/port_mirroring.png" alt="Port Mirroring" decoding="async" />
    </a><p style="text-align: center; font-style: italic; margin-top: 0.5rem; color: #666;">Port Mirroring</p></div>

<p>Affordable managed switches supporting port mirroring are available, such as TP-Link switches. While the setup is straightforward, care must be taken to avoid creating network loops or duplicating traffic.</p>
<h3 id="throwing-star-lan-tap">Throwing Star LAN Tap</h3>
<p>Network traffic can also be captured using a LAN Tap. These devices can be purchased or built. A LAN Tap is positioned between the monitored device and the network, enabling traffic capture without modifying the device or network. The <a href="https://greatscottgadgets.com/throwingstar/" target="_blank" rel="noopener noreffer ">Throwing Star LAN Tap</a> from Great Scott Gadgets is one example of such a device.</p>
<div class="center">
    <a class="lightgallery" href="/images/posts/capture_network_mobile/throwing_star_lan.png" title="Throwing Star LAN Tap" data-thumbnail="/images/posts/capture_network_mobile/throwing_star_lan.png" data-sub-html="<h2>Throwing Star LAN Tap</h2>">
        <img style="display: block; margin-left: auto; margin-right: auto; width: 250px" src="/images/posts/capture_network_mobile/throwing_star_lan.png" alt="Throwing Star LAN Tap" decoding="async" />
    </a><p style="text-align: center; font-style: italic; margin-top: 0.5rem; color: #666;">Throwing Star LAN Tap</p></div>

<h2 id="decrypting-https-traffic">Decrypting HTTPS Traffic</h2>
<p>Most captured network traffic is encrypted using HTTPS. To decrypt HTTPS traffic, a custom root certificate must be installed on the monitored device. This can be accomplished by exporting the certificate from the capture tool (e.g., Mitmproxy) and installing it on the device.</p>
<p>Recent Android versions require applications to be configured to trust user-installed certificates, as they only trust system-installed certificates by default. This configuration can be achieved by modifying the application&rsquo;s network security configuration using tools like <a href="https://github.com/niklashigi/apk-mitm" target="_blank" rel="noopener noreffer ">apk-mitm</a>.</p>
<p>On rooted devices, the custom root certificate can be installed as a system certificate, which will be trusted by all applications. Alternatively, tools like <a href="https://github.com/NVISOsecurity/MagiskTrustUserCerts" target="_blank" rel="noopener noreffer ">Magisk Trust User Certs</a> simplify this process.</p>
<h2 id="bibliography">Bibliography</h2>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>&ldquo;Towards Aggregated Features: A Novel Proxy Detection Method Using NetFlow Data,&rdquo; 2020 IEEE 22nd International Conference on High Performance Computing and Communications, pp. 409-416, 2020. <a href="https://ieeexplore.ieee.org/document/9408011" target="_blank" rel="noopener noreffer ">IEEE Xplore</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-11-15</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="https://bilovus.com/posts/capture_network_mobile/" data-title="Capture Network Traffic on Mobile Devices" data-hashtags="network-capture,packet-analysis,tcpdump,wireshark,openwrt,mitmproxy,pcapdroid,https-decryption,port-mirroring,vpn,traffic-monitoring,IoT"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="https://bilovus.com/posts/capture_network_mobile/" data-title="Capture Network Traffic on Mobile Devices"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://bilovus.com/posts/capture_network_mobile/" data-hashtag="network-capture"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://bilovus.com/posts/capture_network_mobile/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://bilovus.com/posts/capture_network_mobile/" data-title="Capture Network Traffic on Mobile Devices"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fbilovus.com%2fposts%2fcapture_network_mobile%2f&amp;text=Capture%20Network%20Traffic%20on%20Mobile%20Devices" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/network-capture/">Network-Capture</a>,&nbsp;<a href="/tags/packet-analysis/">Packet-Analysis</a>,&nbsp;<a href="/tags/tcpdump/">Tcpdump</a>,&nbsp;<a href="/tags/wireshark/">Wireshark</a>,&nbsp;<a href="/tags/openwrt/">Openwrt</a>,&nbsp;<a href="/tags/mitmproxy/">Mitmproxy</a>,&nbsp;<a href="/tags/pcapdroid/">Pcapdroid</a>,&nbsp;<a href="/tags/https-decryption/">Https-Decryption</a>,&nbsp;<a href="/tags/port-mirroring/">Port-Mirroring</a>,&nbsp;<a href="/tags/vpn/">Vpn</a>,&nbsp;<a href="/tags/traffic-monitoring/">Traffic-Monitoring</a>,&nbsp;<a href="/tags/iot/">IoT</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/posts/secure-offline-data-storage-wear-os/" class="next" rel="next" title="Secure Offline Data Storage on Wear OS Using Steganography">Secure Offline Data Storage on Wear OS Using Steganography<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2025 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://bilovus.com/about/" target="_blank">Oleg Bilovus</a></span>&nbsp;|&nbsp;<span class="license"><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/mhchem.min.js"></script><script>window.config={"comment":{},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.769eafe095cf0d4abc4843d9fc4af7920da42c9970472c6d4547df4eb4530423.js" integrity="sha256-dp6v4JXPDUq8SEPZ/Er3kg2kLJlwRyxtRUffTrRTBCM="></script></body>
</html>
